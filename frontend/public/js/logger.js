/**
 * Production-Ready Logger
 * Generated by mega_patch.py
 * 
 * Features:
 *   - Log levels: DEBUG, INFO, WARN, ERROR
 *   - Production mode: Only WARN and ERROR
 *   - Performance tracking
 *   - Structured logging
 */
(function() {
    'use strict';
    
    const LOG_LEVELS = {
        DEBUG: 0,
        INFO: 1,
        WARN: 2,
        ERROR: 3,
        NONE: 4
    };
    
    // Auto-detect production
    const isProduction = window.location.hostname !== 'localhost' && 
                         !window.location.hostname.includes('127.0.0.1');
    
    const config = {
        level: isProduction ? LOG_LEVELS.WARN : LOG_LEVELS.DEBUG,
        prefix: '[SCP]',
        showTimestamp: !isProduction,
        trackPerformance: !isProduction
    };
    
    const performanceMarks = new Map();
    
    function formatMessage(level, args) {
        const parts = [config.prefix];
        
        if (config.showTimestamp) {
            parts.push(new Date().toISOString().substr(11, 12));
        }
        
        parts.push(`[${level}]`);
        
        return parts.join(' ');
    }
    
    const Logger = {
        setLevel: function(level) {
            if (typeof level === 'string') {
                config.level = LOG_LEVELS[level.toUpperCase()] || LOG_LEVELS.DEBUG;
            } else {
                config.level = level;
            }
        },
        
        debug: function(...args) {
            if (config.level <= LOG_LEVELS.DEBUG) {
                console.log(formatMessage('DEBUG', args), ...args);
            }
        },
        
        info: function(...args) {
            if (config.level <= LOG_LEVELS.INFO) {
                console.info(formatMessage('INFO', args), ...args);
            }
        },
        
        warn: function(...args) {
            if (config.level <= LOG_LEVELS.WARN) {
                console.warn(formatMessage('WARN', args), ...args);
            }
        },
        
        error: function(...args) {
            if (config.level <= LOG_LEVELS.ERROR) {
                console.error(formatMessage('ERROR', args), ...args);
            }
        },
        
        // Performance tracking
        time: function(label) {
            if (config.trackPerformance) {
                performanceMarks.set(label, performance.now());
            }
        },
        
        timeEnd: function(label) {
            if (config.trackPerformance && performanceMarks.has(label)) {
                const duration = performance.now() - performanceMarks.get(label);
                performanceMarks.delete(label);
                this.debug(`${label}: ${duration.toFixed(2)}ms`);
                return duration;
            }
            return 0;
        },
        
        // Group logging
        group: function(label) {
            if (config.level <= LOG_LEVELS.DEBUG) {
                console.group(formatMessage('GROUP', [label]), label);
            }
        },
        
        groupEnd: function() {
            if (config.level <= LOG_LEVELS.DEBUG) {
                console.groupEnd();
            }
        },
        
        // Table output
        table: function(data) {
            if (config.level <= LOG_LEVELS.DEBUG) {
                console.table(data);
            }
        },
        
        // Configuration
        configure: function(options) {
            Object.assign(config, options);
        },
        
        // Check if production
        isProduction: function() {
            return isProduction;
        }
    };
    
    // Expose globally
    window.Logger = Logger;
    
    // Initial log
    Logger.debug('Logger initialized', { isProduction, level: config.level });
})();
